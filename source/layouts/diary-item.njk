{% extends './_wrapper.njk' %}
{% from '../includes/meta.njk' import meta as meta %}
{% from '../includes/subjects.njk' import subjects as subjects %}
{% from '../includes/breadcrumbs.njk' import breadcrumbs as breadcrumbsList %}
{% from '../includes/prevNext.njk' import prevNext as prevNext %}

{% set kidsAges %}
{# How old was Roo when this post was published? #}
{% set roo_milliseconds = date | dateDiff(global.dob_roo) %}
{% set rootwo_milliseconds = date | dateDiff(global.dob_rootwo) %}

{% if roo_milliseconds > 2629800000 %}
Roo was {{ roo_milliseconds | msDuration }}
{% elif roo_milliseconds < 2629800000 and roo_milliseconds > 0 %}
and Roo was born this month
{% else %}
Roo will be born in {{ roo_milliseconds | msDuration(true) }}
{% endif %}
{% if rootwo_milliseconds > 2629800000 %}
and Rootwo was {{ rootwo_milliseconds | msDuration }}.
{% elif rootwo_milliseconds < 2629800000 and rootwo_milliseconds > 0 %}
and Rootwo was born this month.
{% else %}
and Rootwo will be born in {{ rootwo_milliseconds | msDuration(true) }}.
{% endif %}

{% endset %}

{% block content %}
{{ breadcrumbsList({
  classes: 'space--margin-bottom-s',
  items: breadcrumbs
}) }}
{{ meta({
  classes: 'space--margin-bottom-l',
  items: [
    {
      key: 'Date',
      value: date | date('dddd D MMMM YYYY [at] h:mm a')
    }, {
      key: 'Subjects',
      value: subjects(tags)
    } if tags | length > 0, {
      key: 'Kidâ€™s ages',
      value: kidsAges
    }
  ]
}) }}
<div class="prose prose--flow space--margin-bottom-xl">
  {{ content | safe }}
  {% for image in photo %}
    {% figure image.url, image.alt %}
  {% endfor %}
</div>

{% set prevPost = collections.diary | getNextCollectionItem(page) %}
{% set nextPost = collections.diary | getPreviousCollectionItem(page)  %}

{{ prevNext({
  label: 'Navigate between diary posts',
  prev: {
    title: 'Previous diary posts',
    url: {
      link: prevPost.url,
      text: prevPost.data.title
    },
    date: prevPost.date | date('dddd D MMMM YYYY [at] h:mm a')
  } if prevPost,
  next: {
    title: 'Next diary post',
    url: {
      link: nextPost.url,
      text: nextPost.data.title
    },
    date: nextPost.date | date('dddd D MMMM YYYY [at] h:mm a')
  } if nextPost
}) }}
{% endblock %}